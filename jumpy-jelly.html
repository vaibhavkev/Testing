<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jumpy Jelly</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            /* A fresh, modern gradient background */
            background: linear-gradient(170deg, #87CEEB 0%, #B0E0E6 100%);
            color: #0c4a6e; /* A deeper, more modern blue */
            overflow: hidden;
        }
        #game-container {
            position: relative;
            width: 100%;
            max-width: 450px;
            height: 80vh;
            max-height: 800px;
            margin: auto;
            /* Softer border and shadow */
            border: 4px solid rgba(255, 255, 255, 0.5);
            border-radius: 30px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }
        canvas {
            display: block;
            width: 100%;
            height: 100%;
            /* The canvas background is now transparent to show the body gradient */
            background-color: transparent;
            border-radius: 26px;
        }
        #ui-container {
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            /* Center the score */
            display: flex;
            justify-content: center;
            align-items: center;
            pointer-events: none;
        }
        .score-box {
            /* Frosted glass effect */
            background-color: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(5px);
            padding: 12px 24px;
            border-radius: 15px;
            border: 2px solid rgba(255, 255, 255, 0.8);
            font-size: 1.75rem;
            font-weight: 600;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        #game-over-modal {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 25px;
            border: 2px solid white;
            text-align: center;
            z-index: 100;
            width: 85%;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .restart-button {
            margin-top: 25px;
            padding: 15px 30px;
            font-size: 1.2rem;
            font-weight: 600;
            color: white;
            /* A vibrant, modern button color */
            background: linear-gradient(45deg, #3b82f6, #60a5fa);
            border: none;
            border-radius: 15px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
            transition: all 0.2s ease-in-out;
        }
        .restart-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.5);
        }
        .restart-button:active {
            transform: translateY(1px);
            box-shadow: 0 4px 10px rgba(59, 130, 246, 0.4);
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center h-screen p-4">

    <header class="text-center mb-4">
        <h1 class="text-4xl md:text-5xl font-bold">Jumpy Jelly</h1>
    </header>

    <div id="game-container">
        <canvas id="gameCanvas"></canvas>
        <div id="ui-container">
            <div id="score" class="score-box">Score: 0</div>
            <!-- Rank display has been removed -->
        </div>
        <div id="game-over-modal" class="hidden">
            <h2 class="text-4xl font-bold">Game Over</h2>
            <p id="final-score" class="text-2xl mt-4"></p>
            <button id="restart-button" class="restart-button">Restart</button>
        </div>
    </div>

    <footer class="text-center mt-4">
        <p class="text-lg font-semibold">Tap or Click to Jump Higher!</p>
    </footer>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        const scoreEl = document.getElementById('score');
        const gameOverModal = document.getElementById('game-over-modal');
        const finalScoreEl = document.getElementById('final-score');
        const restartButton = document.getElementById('restart-button');

        let jelly, obstacles, stars, frame, score, gameSpeed, gameOver;

        function init() {
            const container = document.getElementById('game-container');
            canvas.width = container.clientWidth;
            canvas.height = container.clientHeight;

            jelly = {
                x: canvas.width / 2,
                y: canvas.height - 100,
                radius: 20,
                vy: 0,
                gravity: 0.4,
                jumpStrength: -10,
                baseBounce: -2.5 // Slightly stronger auto-bounce
            };

            obstacles = [];
            stars = [];
            frame = 0;
            score = 0;
            gameSpeed = 3.5; // Slightly faster game
            gameOver = false;

            scoreEl.textContent = `Score: 0`;
            gameOverModal.classList.add('hidden');
            gameLoop();
        }

        function createObstacle() {
            const width = Math.random() * (canvas.width / 2.5 - 80) + 80;
            const x = Math.random() < 0.5 ? 0 : canvas.width - width;
            obstacles.push({
                x: x,
                y: -50,
                width: width,
                height: 30 // Hitbox height
            });
        }

        function createStar() {
            stars.push({
                x: Math.random() * (canvas.width - 60) + 30,
                y: -20,
                radius: 12
            });
        }
        
        // --- NEW DRAWING FUNCTIONS ---

        function drawJelly() {
            // Create a subtle gradient for the jelly
            const gradient = ctx.createRadialGradient(jelly.x, jelly.y - 5, 5, jelly.x, jelly.y, jelly.radius);
            gradient.addColorStop(0, '#a2f0e1');
            gradient.addColorStop(1, '#76D7C4');
            
            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.arc(jelly.x, jelly.y, jelly.radius, 0, Math.PI * 2);
            ctx.fill();
            
            // Add a clean stroke
            ctx.strokeStyle = '#117A65';
            ctx.lineWidth = 3;
            ctx.stroke();
        }

        function drawCloud(obs) {
            ctx.fillStyle = 'rgba(255, 255, 255, 0.95)';
            ctx.strokeStyle = 'rgba(200, 200, 200, 0.9)';
            ctx.lineWidth = 2;
            
            // Draw a series of circles to form a cloud shape within the obstacle's hitbox
            ctx.beginPath();
            ctx.arc(obs.x + obs.width * 0.3, obs.y + obs.height * 0.5, obs.width * 0.25, 0, Math.PI * 2);
            ctx.arc(obs.x + obs.width * 0.6, obs.y + obs.height * 0.5, obs.width * 0.35, 0, Math.PI * 2);
            ctx.arc(obs.x + obs.width * 0.85, obs.y + obs.height * 0.5, obs.width * 0.15, 0, Math.PI * 2);
            ctx.fill();
        }

        function drawStar(star) {
            // Add a glow effect
            ctx.shadowColor = '#FBBF24'; // Amber color for glow
            ctx.shadowBlur = 15;
            
            ctx.fillStyle = '#FCD34D'; // Brighter star color
            ctx.beginPath();
            ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
            ctx.fill();

            // Reset shadow for other elements
            ctx.shadowBlur = 0;
        }

        function gameLoop() {
            if (gameOver) return;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Update and Draw Jelly
            jelly.vy += jelly.gravity;
            jelly.y += jelly.vy;
            jelly.y += jelly.baseBounce;

            if (jelly.y + jelly.radius > canvas.height) {
                jelly.y = canvas.height - jelly.radius;
                jelly.vy = 0;
            }
            drawJelly();

            // Generate and Draw Obstacles/Stars
            frame++;
            if (frame % 90 === 0) createObstacle();
            if (frame % 65 === 0) createStar();

            obstacles.forEach((obs, index) => {
                obs.y += gameSpeed;
                drawCloud(obs);

                // Rectangular collision detection is simple and effective
                if (jelly.x > obs.x && jelly.x < obs.x + obs.width &&
                    jelly.y > obs.y && jelly.y < obs.y + obs.height) {
                    endGame();
                }
                if (obs.y > canvas.height) obstacles.splice(index, 1);
            });
            
            stars.forEach((star, index) => {
                star.y += gameSpeed;
                drawStar(star);

                const dist = Math.hypot(jelly.x - star.x, jelly.y - star.y);
                if (dist - star.radius - jelly.radius < 1) {
                    score += 10;
                    scoreEl.textContent = `Score: ${score}`;
                    stars.splice(index, 1);
                } else if (star.y > canvas.height) {
                    stars.splice(index, 1);
                }
            });
            
            if (jelly.y - jelly.radius < 0) {
                endGame();
            }

            requestAnimationFrame(gameLoop);
        }

        function jump() {
            if (!gameOver) {
                jelly.vy = jelly.jumpStrength;
            }
        }
        
        function endGame() {
            gameOver = true;
            finalScoreEl.textContent = `Final Score: ${score}`;
            gameOverModal.classList.remove('hidden');
        }

        // Event Listeners
        window.addEventListener('click', jump);
        window.addEventListener('touchstart', (e) => {
            e.preventDefault(); // Prevent double-triggering click
            jump();
        });
        restartButton.addEventListener('click', () => {
            init();
        });
        
        window.addEventListener('resize', init);
        init();
    </script>
</body>
</html>
